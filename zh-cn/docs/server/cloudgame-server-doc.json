{
  "filename": "cloudgame-server-doc.md",
  "__html": "<h1>云游戏服务端接入文档</h1>\n<h2>0.版本变更记录</h2>\n<table>\n<thead>\n<tr>\n<th>修订内容描述</th>\n<th>修订日期</th>\n<th>版本号</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>创建文档</td>\n<td>20140130</td>\n<td>1.0</td>\n</tr>\n<tr>\n<td>去掉goodscount参数</td>\n<td>20140221</td>\n<td>1.1</td>\n</tr>\n<tr>\n<td>重构文档</td>\n<td>20140226</td>\n<td>1.2</td>\n</tr>\n<tr>\n<td>增加手机话费支付更新商品信息说明。</td>\n<td>20140311</td>\n<td>1.3</td>\n</tr>\n<tr>\n<td>增加Android客户端集成支付SDK</td>\n<td>20140312</td>\n<td>1.4</td>\n</tr>\n<tr>\n<td>修改Android客户端集成支付SDK说明</td>\n<td>20150527</td>\n<td>1.5</td>\n</tr>\n<tr>\n<td>增加文字描述</td>\n<td>20150909</td>\n<td>1.6</td>\n</tr>\n<tr>\n<td>更新银联SDK</td>\n<td>20150916</td>\n<td>1.7</td>\n</tr>\n<tr>\n<td>新增网易支付SDK</td>\n<td>20160504</td>\n<td>1.8</td>\n</tr>\n<tr>\n<td>新增微信支付SDK</td>\n<td>20160605</td>\n<td>1.9</td>\n</tr>\n<tr>\n<td>更新网易支付SDK</td>\n<td>20160711</td>\n<td>2.0</td>\n</tr>\n<tr>\n<td>添加透传机制</td>\n<td>20161226</td>\n<td>2.1</td>\n</tr>\n<tr>\n<td>增加获取用户信息接口</td>\n<td>20170915</td>\n<td>2.2</td>\n</tr>\n<tr>\n<td>增加支付流程角色说明</td>\n<td>20170917</td>\n<td>2.3</td>\n</tr>\n<tr>\n<td>梳理异常和签名错误FAQ</td>\n<td>20171010</td>\n<td>2.4</td>\n</tr>\n<tr>\n<td>文档markdown，删除无用信息</td>\n<td>20180813</td>\n<td>2.5</td>\n</tr>\n<tr>\n<td>支付流程变更</td>\n<td>20210104</td>\n<td>3.0</td>\n</tr>\n</tbody>\n</table>\n<h2>1.支付流程</h2>\n<p><font color=red>重大提醒：</font>客户端5.3.0之前版本下单流程由游戏服务端发起，客户端5.3.0版本及以上由客户端直接发起下单，服务器不再需要请求原下单接口，请各游戏渠道做到版本兼容。</p>\n<h3>1.1 支付中各角色交互说明</h3>\n<p><img src=\"https://nosdn-yx.127.net/yxgame/067e22fdee9d2839b24efd1b99bfbd87.jpg\" alt=\"支付中各角色交互说明\"></p>\n<p><strong>参与支付流程交互的角色有：</strong></p>\n<ul>\n<li><strong>游戏APP（以下也称第三方App）</strong>：需要集成易信游戏SDK\n<ul>\n<li>调用游戏Server接口生成订单</li>\n<li>调用SDK接口进行支付</li>\n</ul>\n</li>\n<li><strong>游戏Server（以下也称第三方服务器）</strong>：\n<ul>\n<li>负责生成订单，并将订单信息持久化到第三方服务器</li>\n<li>负责接收易信游戏Server支付回调，处理发货逻辑</li>\n</ul>\n</li>\n<li><strong>易信游戏Server（以下也称PayServer）</strong>\n<ul>\n<li>根据游戏Server订单，生成订单信息（Trade信息），返回给游戏App</li>\n<li>接收支付工具Server（如支付宝、微信等）的回调，并回调游戏Server接口</li>\n</ul>\n</li>\n</ul>\n<p>从上面的描述中，第三方游戏接入易信游戏仅需要关心以下部分流程:</p>\n<ol>\n<li>游戏App向游戏Server发起生成订单</li>\n<li>游戏App调用易信游戏SDK接口发起支付</li>\n<li>游戏Server接收易信游戏Server异步支付成功回调</li>\n</ol>\n<h3>1.2 完整交易流程</h3>\n<p><img src=\"https://nosdn-yx.127.net/yxgame/9f90aedb103cdde8459dcd908662b138.jpg\" alt=\"\"></p>\n<p><strong>流程说明</strong></p>\n<p>由流程图可知</p>\n<ol>\n<li><code>第三方APP</code>负责调用<code>第三方Server``生成订单1.1</code>，并处理返回值、调用支付接口。用户支付完成后，<code>SDK</code>回调<code>接口返回支付结果2.7</code>给<code>第三方APP</code></li>\n<li><code>第三方Server</code>负责生成订单，并将订单信息持久化到数据库。</li>\n<li><code>第三方Server</code>负责处理支付通知，并对支付成功的订单进行发货、更改数据库状态，在支付成功后，<code>PayServer</code>通过<code>异步发送支付通知4.1</code>通知<code>第三方Server</code>发货，<code>第三方Server</code>自行进行发货。</li>\n</ol>\n<p><strong><code>流程注意点</code></strong></p>\n<ol>\n<li>调用支付接口时都<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>必须</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">传递用户的access_token，用于提取用户名、验证。</li>\n<li><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>任一步</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">都可能中断，要保证最终数据的一致性、正确。比如悬挂订单最终要超时。</li>\n<li><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>任一步</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">都要签名，防篡改、欺骗、重放。</li>\n<li><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>任一步</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">都有可能多次重复调用，被调用者负责去重。</li>\n</ol>\n<h2>2.服务端接口</h2>\n<p>服务器端接口包括<code>第三方Server</code>、<code>PayServer</code>提供给对方和Android客户端的接口。主要包括订单生成、支付通知两类接口。考虑到安全性，除了用户输入、UI交互接口需要在Android端完成，其他跟支付有关的接口必须在服务器端进行调用。签名由服务器端进行，公钥不要暴露在Android端。</p>\n<h3>2.1 接口约定</h3>\n<h4>2.1.1 订单信息持久化</h4>\n<p><code>第三方Server</code>需要对订单信息包括订单id、支付状态、各类时间戳等信息、接口参数使用数据库进行持久化用来对账。</p>\n<h4>2.1.2 支付通知并发</h4>\n<p>支付完成后<code>Payserver</code>调用<code>第三方Server</code>接口通知发货，相同订单支付通知接口可能被调用多次，需要去重并避免重复发货等问题。如更新数据库时可以使用类似的SQL:</p>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">update</span> Trade <span class=\"hljs-keyword\">set</span> PayState=Payed <span class=\"hljs-keyword\">where</span> PayState=UnPay <span class=\"hljs-keyword\">and</span> <span class=\"hljs-keyword\">Id</span>=?;\n</code></pre>\n<h4>2.1.3 两个公钥，一个私钥<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>很重要</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"></h4>\n<p>易信游戏需要两个公钥一个私钥。请<code>谨记</code>括号里面的名字。</p>\n<ol>\n<li>游戏方接入方公钥及私钥请联系贵方商务或运营从开发者后台获取。(以下称<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>游戏方公钥</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">或<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>游戏方私钥</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">)\n<img src=\"http://nosdn-yx.127.net/yxgame/0be8e326369a4f64a44b03c193faf243.jpg\" alt=\"游戏方接入方公私钥获取\"></li>\n<li>平台公钥(以下称<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>平台公钥</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">)</li>\n</ol>\n<pre><code>30819f300d06092a864886f70d010101050003818d0030818902818100ac1b8d63bcaf49cdd0d1e79c916aba0250421b3ee8eaf134f80843c5033e30a150b9e26e78025fde8e52538d4beb572940966b0c80460d90a26c9119a0d28c4277024dbeb20e31403360aeca70da506a19d89e95512e5347be0eae9b2c49da3150a93e3bc80817fa9a1d8170555e6117c86f84f13afc39944fb6bdfc85e3723b0203010001\n</code></pre>\n<h4><h4 id='sign'>2.1.4 签名校验及参数值编码</h4></h4>\n<p><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>非常重要</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">绝大部分平台接入失败都卡在签名这一步，请仔细阅读下面各点。</p>\n<h5>2.1.4.1 注意点</h5>\n<ol>\n<li>拼接在请求URL上的参数，需要进行URLEncode, 如<code>String param = URLEncoder.encode(&quot;2014-01-01 12:12:12&quot;, &quot;UTF-8&quot;);</code>, 输出为<code>2014-01-01+12%3A12%3A12</code></li>\n<li><code>第三方Server</code>接收<code>PayServer</code>的支付通知回调接口的<code>sign签名</code>字段操作\n<ul>\n<li>将参与签名的参数进行<code>字符串拼接</code> (参与签名计算的参数会在每个接口中进行说明)</li>\n<li><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>需要、需要、需要</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">进行<code>URLEncode</code></li>\n<li>使用<code>Android Demo</code>工程的类<code>im.yixin.game.demo.rsa.RSA</code>中的<code>RSA.verify()</code>接口和<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>平台公钥</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">以及上述拼接字符串验证<code>sign</code>参数是否正确，正确再执行业务逻辑</li>\n</ul>\n</li>\n</ol>\n<h5>2.1.4.2 生成和验证签名Java Demo</h5>\n<p><a href=\"https://163yungame.github.io/zh-cn/util/index.html\">在线验证签名</a></p>\n<ul>\n<li>生成签名流程</li>\n</ul>\n<pre><code class=\"language-java\"><span class=\"hljs-comment\">// 生成签名 需要哪些参数请仔细看每个接口的说明</span>\nStringBuilder signSrcSb = <span class=\"hljs-keyword\">new</span> StringBuilder();\nsignSrcSb.append(v);\nsignSrcSb.append(thirdpart_orderid);\nsignSrcSb.append(thirdpart_ordertime);\nsignSrcSb.append(tradeName);\nsignSrcSb.append(access_token);\n<span class=\"hljs-comment\">// 如果goodscount为1或不传则不需要添加此项</span>\n<span class=\"hljs-keyword\">if</span> (goodscount &gt; <span class=\"hljs-number\">1L</span>) {\n    signSrcSb.append(goodscount);\n}\n<span class=\"hljs-comment\">// 需不需要Encode，参考每个接口的说明，每个都不一样，请仔细看，不需要的话直接用</span>\n<span class=\"hljs-comment\">// String signSrc = signSrcSb.toString(); 即可</span>\nString signSrc = URLEncoder.encode(signSrcSb.toString(), <span class=\"hljs-string\">\"UTF-8\"</span>);\n<span class=\"hljs-comment\">// 注意看接口说明，一般情况生成签名用privateKey，验证签名用publicKey</span>\nPrivateKey privateKey = RSA.getPrivateKey(<span class=\"hljs-string\">\"游戏方私钥\"</span>);\nString sign = RSA.sign(privateKey, signSrc);\n</code></pre>\n<ul>\n<li>验证签名流程</li>\n</ul>\n<pre><code class=\"language-java\"><span class=\"hljs-comment\">// 验证签名 具体需要拼接哪些参数，请查看后续接口文档</span>\nStringBuilder signSrcSb4Ret = <span class=\"hljs-keyword\">new</span> StringBuilder();\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"v\"</span>));\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"thirdpart_orderid\"</span>));\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"thirdpart_ordertime\"</span>));\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"result\"</span>));\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"trade_serialid\"</span>));\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"goodsprice\"</span>));\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"goodsamount\"</span>));\nsignSrcSb4Ret.append(retMap.get(<span class=\"hljs-string\">\"pay_url\"</span>));\n<span class=\"hljs-keyword\">if</span> (goodscount &gt; <span class=\"hljs-number\">1L</span>) {\n    signSrcSb4Ret.append(goodscount);\n}\n<span class=\"hljs-comment\">//</span>\nPublicKey publicKey = RSA.getPublicKey(<span class=\"hljs-string\">\"平台公钥\"</span>)\n<span class=\"hljs-comment\">// signSrcSb4Ret.toString() 查看接口文档决定此处是否需要URLEncode</span>\n<span class=\"hljs-comment\">// 验证失败则抛出异常</span>\nRSA.verify(publicKey, sign, signSrcSb4Ret.toString());\n</code></pre>\n<h3>2.2 返回异常说明</h3>\n<table>\n<thead>\n<tr>\n<th>异常码</th>\n<th>说明</th>\n<th>用户页面提示文案</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-1</td>\n<td>服务器内部异常。未知异常，或无需详细说明的一般性异常。</td>\n<td>支付请求失败，请重试</td>\n</tr>\n<tr>\n<td>-2</td>\n<td>登陆账号异常</td>\n<td>账号登录失败，请重试</td>\n</tr>\n<tr>\n<td>-3</td>\n<td>生成签名失败</td>\n<td>生成签名失败，请重试</td>\n</tr>\n<tr>\n<td>-4</td>\n<td>验证签名失败</td>\n<td>验证签名失败，请重试</td>\n</tr>\n<tr>\n<td>-5</td>\n<td>商品不存在</td>\n<td>商品不存在，请重试</td>\n</tr>\n<tr>\n<td>-6</td>\n<td>订单不存在</td>\n<td>订单不存在，请重试</td>\n</tr>\n<tr>\n<td>-7</td>\n<td>支付方式错误</td>\n<td>支付方式错误，请重试</td>\n</tr>\n<tr>\n<td>-8</td>\n<td>参数非法</td>\n<td>参数非法</td>\n</tr>\n<tr>\n<td>-9</td>\n<td>支付超时</td>\n<td>支付超时，请重新支付</td>\n</tr>\n<tr>\n<td>-10</td>\n<td>更新支付类型失败(已经有支付类型或者已经支付)</td>\n<td>更新支付类型失败</td>\n</tr>\n<tr>\n<td>-31</td>\n<td>第三方订单号重复</td>\n<td>订单重复</td>\n</tr>\n<tr>\n<td>-51</td>\n<td>支付工具通知的支付状态非法</td>\n<td>无效订单</td>\n</tr>\n<tr>\n<td>-101</td>\n<td>服务器内部错误，数据库异常</td>\n<td>支付数据请求失败，请重试</td>\n</tr>\n<tr>\n<td>-1001</td>\n<td>渠道游戏的状态为停用，无法下单</td>\n<td>无效订单</td>\n</tr>\n</tbody>\n</table>\n<h3>2.3 PayServer异步支付通知</h3>\n<p>本接口为流程图中的<code>异步发送支付通知 4.1</code>接口。Android页面通知可能因为网络故障导致通知失败，需要<code>PayServer</code>多次异步通知来保证通知到<code>第三方Server</code>。</p>\n<ol>\n<li><code>第三方Server</code>可以将此接口和Android页面通知接口在同一个接口中合并处理，此接口增加了<code>notifyid</code>、<code>notifytime</code>两个参数，并且<code>from</code>值不一样。</li>\n<li><code>第三方Server</code>需要去重，可能会重复通知，避免多次发货</li>\n<li>当<code>第三方Server</code>响应<code>success</code>字符串时，<code>PayServer</code>停止异步通知，否则按如下时间间隔不断通知直到收到<code>success</code>：40秒、2分钟、5分钟、10分钟、30分钟、1小时、2小时、6小时、15小时，超过以上时间后，即使没接收到<code>success</code>也不再通知。</li>\n</ol>\n<h4>2.3.1 接口定义</h4>\n<ul>\n<li>URL: <code>第三方Server</code>定义并填写到开发者后台的对应游戏配置中</li>\n<li>提供方: <code>第三方Server</code></li>\n<li>调用方: <code>PayServer</code></li>\n<li>请求方式: <code>POST</code></li>\n</ul>\n<h4>2.3.2 请求参数</h4>\n<p><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>拼接在URL中</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"></p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>参数名称(FulfillWithEngCharacter)</th>\n<th>参数说明</th>\n<th>类型(字符长度)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>v</td>\n<td>接口版本号</td>\n<td></td>\n<td>String</td>\n</tr>\n<tr>\n<td>thirdpart_orderid</td>\n<td>第三方唯一订单id</td>\n<td></td>\n<td>String</td>\n</tr>\n<tr>\n<td>thirdpart_ordertime</td>\n<td>第三方订单下单时间</td>\n<td></td>\n<td>String</td>\n</tr>\n<tr>\n<td>tradeName</td>\n<td>商品名称</td>\n<td></td>\n<td>String</td>\n</tr>\n<tr>\n<td>result</td>\n<td>返回结果</td>\n<td>正常0、异常时返回异常号。返回异常时其他字段可能不返回。</td>\n<td>int</td>\n</tr>\n<tr>\n<td>trade_serialid</td>\n<td>支付平台订单序列号</td>\n<td></td>\n<td>String</td>\n</tr>\n<tr>\n<td>goodsprice</td>\n<td>商品单价</td>\n<td>单位元，精确到分，如0.01元</td>\n<td>String</td>\n</tr>\n<tr>\n<td>goodsamount</td>\n<td>支付金额</td>\n<td>单位元，精确到分，如0.01元</td>\n<td>String</td>\n</tr>\n<tr>\n<td>paystatus</td>\n<td>支付结果</td>\n<td>支付状态：0未支付1已支付成功2关闭。result返回0时才有此字段。</td>\n<td>int</td>\n</tr>\n<tr>\n<td>paytime</td>\n<td>付款时间</td>\n<td></td>\n<td>long</td>\n</tr>\n<tr>\n<td>paytooltype</td>\n<td>支付工具类型</td>\n<td></td>\n<td>int</td>\n</tr>\n<tr>\n<td>notifyid</td>\n<td>通知内部id</td>\n<td>用于校验</td>\n<td>long</td>\n</tr>\n<tr>\n<td>notifytime</td>\n<td>通知时间戳</td>\n<td></td>\n<td>long</td>\n</tr>\n<tr>\n<td>from</td>\n<td>来源参数</td>\n<td>值固定为<code>backend</code></td>\n<td>String</td>\n</tr>\n<tr>\n<td>sign</td>\n<td>签名</td>\n<td>请先阅读<a href=\"#sign\">2.1.4 签名校验及参数值编码</a>,参与签名的参数<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">严格<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">依照以下顺序，中间的<code>+</code>表示前后字符串直接拼接，不要把<code>+</code>加到字符串中，拼接后<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>需要URLEncode</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">, <code>v+thirdpart_orderid+thirdpart_ordertime+tradeName+result+trade_serialid+goodsprice+goodsamount+paystatus+paytime+paytooltype+notifyid+notifytime+from</code>,使用<img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\"><code>平台公钥</code><img src=\"http://nosdn-yx.127.net/yxgame/d90c6c4f9c6d4f668739eb8f40b34e4a.png\" alt=\"\">进行签名验证计算</td>\n<td>String</td>\n</tr>\n</tbody>\n</table>\n<h4>2.3.3 返回值</h4>\n<p>成功处理则返回<code>success</code>这7个字符，失败返回<code>fail</code>。</p>\n<h3>2.4 获取用户信息</h3>\n<p>获取用户信息，校验access_token有效性, 本接口无签名校验</p>\n<h4>2.4.1 接口定义</h4>\n<ul>\n<li>URL: <code>https://open.game.163.com/api/user/info</code></li>\n<li>提供方: <code>PayServer</code></li>\n<li>调用方: <code>第三方Server</code></li>\n<li>请求方式: <code>GET</code></li>\n</ul>\n<h4>2.4.2 请求参数</h4>\n<p>拼接在URL中</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>参数名称(FulfillWithEngCharacter)</th>\n<th>参数说明</th>\n<th>类型(字符长度)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>access_token</td>\n<td>token值</td>\n<td>从客户端获取的token值</td>\n<td>String</td>\n</tr>\n</tbody>\n</table>\n<h4>2.4.3 返回值</h4>\n<ul>\n<li>返回值格式: <code>JSON</code></li>\n<li>异常返回格式: <code>非1</code>的<code>code</code>值都是异常返回，<code>code</code>一定有，<code>errorMsg</code>可能没有</li>\n</ul>\n<pre><code class=\"language-json\">{\n\t<span class=\"hljs-attr\">\"code\"</span>: <span class=\"hljs-number\">400</span>,\n\t<span class=\"hljs-attr\">\"errorMsg\"</span>: <span class=\"hljs-string\">\"access_token is illegal,oauthUserApp is empty\"</span>\n}\n</code></pre>\n<ul>\n<li>正常返回时，<code>code</code>值为<code>1</code></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>参数名称(FulfillWithEngCharacter)</th>\n<th>参数说明</th>\n<th>类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>code</td>\n<td>响应码</td>\n<td>响应码，1为正确，其他都是异常</td>\n<td>int</td>\n</tr>\n<tr>\n<td>userinfo</td>\n<td>用户信息</td>\n<td>code为1时有</td>\n<td>Object</td>\n</tr>\n<tr>\n<td>accountId</td>\n<td>支付方用户账号</td>\n<td>包含在userinfo内，支付方用户账号</td>\n<td>String</td>\n</tr>\n<tr>\n<td>nick</td>\n<td>用户昵称</td>\n<td>包含在userinfo内，用户昵称</td>\n<td>String</td>\n</tr>\n<tr>\n<td>icon</td>\n<td>用户头像</td>\n<td>包含在userinfo内，用户头像</td>\n<td>String</td>\n</tr>\n<tr>\n<td>registerUser</td>\n<td>为用户是否在支付方已经实名认证</td>\n<td>包含在userinfo内，是否在支付方已经实名认证</td>\n<td>boolean</td>\n</tr>\n</tbody>\n</table>\n<p>示例</p>\n<pre><code class=\"language-json\">{\n\t<span class=\"hljs-attr\">\"userinfo\"</span>: {\n\t\t<span class=\"hljs-attr\">\"accountId\"</span>: <span class=\"hljs-string\">\"7a950a752ca8bef6\"</span>,\n\t\t<span class=\"hljs-attr\">\"nick\"</span>: <span class=\"hljs-string\">\"yazhitest\"</span>,\n\t\t<span class=\"hljs-attr\">\"icon\"</span>: <span class=\"hljs-string\">\"http://nos.netease.com/yixinpublic/pr_tp8qsfuk8xlsyhj98qooeq==_1422263772_13102\"</span>,\n\t\t<span class=\"hljs-attr\">\"registerUser\"</span>: <span class=\"hljs-literal\">true</span>\n\t},\n\t<span class=\"hljs-attr\">\"code\"</span>: <span class=\"hljs-number\">1</span>\n}\n</code></pre>\n",
  "link": "/zh-cn/docs/server/cloudgame-server-doc.html",
  "meta": {}
}